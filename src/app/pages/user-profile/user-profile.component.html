<div class="profile-container">
  <!-- CARD PROFIL -->
  <div class="card">
    <h2>Profil utilizator</h2>
    <img [src]="profilePicUrl" alt="Profile Picture" class="profile-pic clickable" />

    <p><strong>First Name:</strong> {{ firstName }}</p>
    <p><strong>Last Name:</strong> {{ lastName }}</p>
    <p><strong>Username:</strong> {{ username }}</p>
    <p><strong>Email:</strong> {{ email }}</p>
    <p><strong>Registered on:</strong> {{ createdAt | date: 'longDate' }}</p>

    <button (click)="openEditModal()">EditeazƒÉ profil</button>
  </div>

  <!-- CARD LEC»öII -->
<div class="card">
  <h3>Lec»õii completate</h3>
  <p class="test-info">
    Vrei sƒÉ generezi un test cu lec»õiile pe care nu le stƒÉp√¢ne»ôti at√¢t de bine?
    <br />
    Click pe butonul de mai jos!
  </p>

  <!-- üîπ Buton de ac»õiune -->
  <button class="test-button" (click)="selectLessonsForTest()">SelecteazƒÉ lec»õii pentru test</button>

  <!-- ‚¨áÔ∏è ADƒÇUGAT WRAPPER SCROLLABIL -->
  <div class="card-lessons-scroll">
    <div *ngFor="let level of ['beginner', 'intermediate', 'advanced']">
      <h4>{{ level | titlecase }} Level</h4>
      <ng-container *ngIf="completedLessonsByLevel[level] as lessons">
        <ul *ngIf="lessons.length > 0; else none">
          <li *ngFor="let lesson of lessons">
            {{ lesson.title }}
          </li>
        </ul>
      </ng-container>
      <ng-template #none>
        <p><em>No completed lessons yet.</em></p>
      </ng-template>
    </div>
  </div>
</div>

<div class="modal-overlay" *ngIf="showModal">
  <div class="modal">
    <h3>Editare Profil</h3>

    <!-- Imaginea de profil curentƒÉ -->
    <img [src]="tempProfilePic || profilePicUrl" alt="Preview" class="profile-pic-preview" />

    <div class="modal-buttons">
      <button (click)="triggerFileInput()">Change Profile Picture</button>
      <button (click)="removeProfilePicture()">Remove Profile Picture</button>
    </div>

    <input type="file" id="fileInput" accept="image/*" (change)="onFileSelected($event)" hidden />

    <!-- Campuri pentru nume -->
    <label>Prenume:</label>
    <input type="text" [(ngModel)]="tempFirstName" />

    <label>Nume:</label>
    <input type="text" [(ngModel)]="tempLastName" />

    <label>Username:</label>
    <input type="text" [(ngModel)]="tempUsername" (blur)="checkUsernameAvailability()" />
    <div class="error" *ngIf="usernameError">{{ usernameError }}</div>    

    <div class="modal-buttons">
      <button (click)="saveChanges()">Save Changes</button>
      <button (click)="closeModal()">Cancel</button>
    </div>
  </div>
</div>
